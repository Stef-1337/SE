<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui" xmlns:h="http://java.sun.com/jsf/html"
                template="/WEB-INF/template/default.xhtml">
    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam name="channelBicycle" value="#{bicycleDetailView.channel}"/>
        </f:metadata>

    </ui:define>

    <ui:define name="content">


        <div class="card">
            <p:panel header="BikeDashboard">
                <h:panelGrid columns="5" cellpadding="10" styleClass="mb-3">
                    <h:column>
                        <h:form id="auswahl1">
                            <h:outputLabel for="selectOne" value="Fahrrad 1: "/>
                            <h:selectOneMenu id="selectOne" value="#{bicycleDetailView.channel}" required="true"
                                             label="Text 3" var="c">
                                <f:selectItems value="#{bicycleDetailView.getBicycles()}"
                                               var="b"
                                               itemValue="#{b.channel}"
                                               itemLabel="#{b.channel}"
                                               itemDescription="#{b.channel}"
                                               itemDisabled="#{b.channel}"
                                               itemLabelEscaped="true"
                                               noSelectionValue="#{bicycleDetailView.getBicycles()[0]}"/>
                                <f:ajax execute="auswahl1" render="chart"/>
                            </h:selectOneMenu>
                        </h:form>
                    </h:column>

                    <h:column>
                        <h:form>
                            <div class="field col-12 md:col-4">
                                <h:outputLabel for="kennzahl" value="Kennzahl: "/>
                                <h:selectOneMenu id="kennzahl" value="#{bicycleDetailView.keyFigure}" required="true"
                                                 label="Text 4">
                                    <f:selectItems value="#{bicycleDetailView.keyFigures}"/>
                                    <f:ajax execute="kennzahl" render="chart"/>
                                </h:selectOneMenu>
                            </div>
                        </h:form>
                    </h:column>

                    <h:column>
                        <h:form id="dauer">
                            <div class="field col-12 md:col-4">
                                <p:outputLabel for="range" value="Betrachtungszeitraum: "/>
                                <p:datePicker id="range" selectionMode="range" value="#{bicycleDetailView.timeRange}"
                                              showTime="true" locale="de" pattern="dd.MM.yyyy" readonlyInput="true">
                                    <f:ajax execute="#{bicycleDetailView.resetStep()}" render="testOutput"/>
                                    <f:ajax execute="dauer" render="chart"/>
                                </p:datePicker>
                            </div>
                        </h:form>
                    </h:column>

                    <h:column>
                        <div class="card">
                            <h:form>
                                <p:growl id="msg"/>
                                <p:selectBooleanCheckbox id="gl채tten" value="#{bicycleDetailView.smoothed}"
                                                         itemLabel="Werte gl채tten">
                                    <!--                                        <p:ajax update="msg" listener="#{selectBooleanView.addMessage}"/>-->
                                    <f:ajax execute="gl채tten" render="chart"/>
                                </p:selectBooleanCheckbox>
                            </h:form>
                        </div>
                    </h:column>

                    <h:column>
                        <h:form id="auswahl2">
                            <h:outputLabel for="selectTwo" value="Fahrrad 2: "/>
                            <h:selectOneMenu id="selectTwo" value="#{bicycleDetailView.channel2}" required="true"
                                             label="Text 3" var="c">
                                <f:selectItem itemLabel="Select One" itemValue="" noSelectionOption="true"/>
                                <f:selectItems value="#{bicycleDetailView.getBicycles()}"
                                               var="b"
                                               itemValue="#{b.channel}"
                                               itemLabel="#{b.channel}"
                                               itemDescription="#{b.channel}"
                                               itemDisabled="#{b.channel}"
                                               itemLabelEscaped="true"
                                               noSelectionValue=""/>
                                <f:ajax execute="auswahl2" render="chart"/>
                            </h:selectOneMenu>
                        </h:form>
                    </h:column>
                </h:panelGrid>

                <p:growl id="messages"/>
            </p:panel>


        </div>

        <h:form id="chartForm">
            <p:outputPanel  id="graph" styleClass="mb-3">
                <p:autoUpdate/>
                <p:lineChart id="chart"
                             model="#{bicycleLineChartView.getLineModel('Fahraddaten', bicycleDetailView.step, bicycleDetailView.factor, bicycleDetailView.keyFigure, bicycleDetailView.timeRange, bicycleDetailView.channel, bicycleDetailView.channel2)}"/>
            </p:outputPanel>
            <p:poll interval="10" update="graph"/>
        </h:form>


    </ui:define>
    <ui:define name="footer">
        <h:form id="testOutput">
            Geladen bicycle mit dem Channel #{bicycleDetailView.status.channel}
            Rotationsfrequenz: #{bicycleDetailView.status.channel}
            <br/>
            <p:outputLabel value="#{bicycleDetailView.step}"/>
            <p:autoUpdate/>
        </h:form>

    </ui:define>

    <ui:define name="rechts">
        <div class="card">
            <p:panel header="Numerische Kennzahlen">
                <h:panelGrid columns="1" cellpadding="5" style="margin-left:auto; margin-right:auto;" styleClass="mb-3">
                    <h:form id="numForm">
                        <div class="field col-12 md:col-4">
                            <p:selectOneMenu id="num" value="#{bicycleLineChartView.numSelected}}">
                                <f:selectItem itemLabel="Select One" itemValue=""/>
                                <f:selectItem itemLabel="#{bicycleLineChartView.average}" itemValue="2"/>
                                <f:selectItem itemLabel="#{bicycleLineChartView.total}" itemValue="3"/>
                                <f:ajax execute="num" render="numselected"/>
                            </p:selectOneMenu>
                            <p:outputLabel styleClass="headline_class" id="numselected" value="#{bicycleLineChartView.numSelected}"/>
                        </div>
                    </h:form>


                </h:panelGrid>
                <h:panelGrid styleClass="mb-3" style="margin-left:auto; margin-right:auto;">
                    <h:form id="output">
<!--                        <p:outputLabel styleClass="headline_class" id="numselected" value="#{bicycleLineChartView.numSelected}"/>-->
                        <h1> #{bicycleLineChartView.numSelected} </h1>
                        <h1> #{bicycleLineChartView.average} </h1>
                        <h1> #{bicycleLineChartView.total} </h1>
                    </h:form>

                </h:panelGrid>
            </p:panel>
        </div>

        <div class="card">
            <h:form>
                <p:panel header="Intervalll채nge" style="margin-left:auto !important; margin-right:auto !important;" styleClass="mb-3">
                    <h:panelGrid columns="1" cellpadding="5" style="margin-left:auto; margin-right:auto;" styleClass="mb-3">
                        <p:column>
                            <h:inputText value="#{bicycleDetailView.step}" styleClass="inputNumber"/>
                        </p:column>
                    </h:panelGrid>
                    <h:panelGrid columns="1" cellpadding="5" style="margin-left:auto; margin-right:auto;" styleClass="mb-3">
                        <h:column>
                            <h:selectOneMenu id="timeUnit" value="#{bicycleDetailView.timeUnit}" required="true"
                                             label="Text 5">
                                <f:selectItem itemLabel="ms" itemValue="MILLIS" noSelectionOption="true"/>
                                <f:selectItem itemLabel="sec" itemValue="SECONDS" noSelectionOption="true"/>
                                <f:selectItem itemLabel="min" itemValue="MINUTES" noSelectionOption="true"/>
                                <f:selectItem itemLabel="h" itemValue="HOURS"
                                              noSelectionOption="true"/>
                                <f:selectItem itemLabel="d" itemValue="DAYS" noSelectionOption="true"/>
                                <!--                                    <f:ajax execute="ti" render="chart"/>-->
                            </h:selectOneMenu>
                        </h:column>
                    </h:panelGrid>
                    <h:panelGrid columns="1" cellpadding="5" style="margin-left:auto; margin-right:auto;" styleClass="mb-3">
                        <p:commandButton value="OK" id="btn" process="@all" styleClass="mr-2">
                            <f:ajax render="chart"/>
                        </p:commandButton>

                    </h:panelGrid>
                </p:panel>
            </h:form>
        </div>
    </ui:define>
</ui:composition>
